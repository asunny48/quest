name: Continuous Integration (CI)
on:
  push:
    branches:
      - main
  pull_request:

jobs:
  # lint:
  #   name: Lint
  #   uses: ./.github/workflows/tflint.yml@main

  # tfsec:
  #   name: TFSec
  #   uses: ./.github/workflows/tfsec.yml@main

  infracost:
    name: Infracost
    uses: ./.github/workflows/infracost.yml@main
    with:
      get_cloudflare_tfvars: true
    secrets:
      INFRACOST_API_KEY: ${{ secrets.INFRACOST_API_KEY }}
      KEYBASE_USER: ${{ secrets.KEYBASE_USER }}
      KEYBASE_PAPERKEY: ${{ secrets.KEYBASE_PAPERKEY }}